"use strict";(this.webpackChunk_hz_project_x=this.webpackChunk_hz_project_x||[]).push([[26724],{732717:(t,e,i)=>{i.d(e,{q:()=>r});const r={brickActivatePerf:new(i(34182).L0)("brick-activate-perf",!1)}},495825:(t,e,i)=>{i.d(e,{w:()=>r});class r{constructor(t){this.locator=t}async activateOnDemandBrick(t){return Promise.reject(new Error("On-demand brick activation not supported."))}}},892905:(t,e,i)=>{i.d(e,{S:()=>r});class r{constructor(t,e,i){this._appConfig=t,this._getDependencies=e,this._brickValidator=i}shouldInertBrick(t,e){return!(!t.requiredFlags||t.requiredFlags.every((t=>e[t])))||!(!t.requiredDraftModels||t.requiredDraftModels.every((t=>e[t])))}async collectBricksAndDependencies(t){const e=new Set,i=await this._appConfig.getFeatures(!0);for(const r of t)this._collectBrickAndDependencies(r,i,e);return[...e]}_collectBrickAndDependencies(t,e,i=new Set,r=[]){if(-1!==r.indexOf(t))throw new Error(`Circular brick dependency detected for brick "${t.id}" - ancestors: [${r.join(", ")}]`);if(i.has(t))return;if(this.shouldInertBrick(t,e))return;i.add(t),r.push(t);const a=void 0!==this._brickValidator;if(a&&!this._brickValidator.isValidLevel(t.level))throw new Error(`Invalid brick level for ${t.id}`);const s=this._getDependencies(t);for(const n of s){if(a&&!this._brickValidator.isValidLevelDependency(t.level,n.level))throw new Error(`Invalid brick level dependency from ${t.id} (${t.level}) to ${n.id} (${n.level})`);this._collectBrickAndDependencies(n,e,i,r)}r.pop()}}},374966:(t,e,i)=>{i.d(e,{i:()=>m});var r=i(501631),a=i(718187),s=i(969542),n=i(495825),o=i(732717),c=i(892905),h=i(330761),d=i(848563),l=i(704237);class m{constructor(t,e,i){this._appConfig=t,this._perf=e,this._activeBrickEntries=new Map,this._isBrickActivatePerfEnabledDeferred=new r.B;const a=(0,d.Z)();this._perf.beginAction(h.l.brickManagerConstruction,h.l.brickManagerConstruction,a,void 0,{marked:!0}),this._isBrickActivatePerfEnabledDeferred.adopt(this._appConfig.attach(o.q).then((()=>o.q.brickActivatePerf.enabled)));this._brickDependencyCollector=new c.S(this._appConfig,(t=>t.dependencies??[]),i),this._perf.endAction(a)}isBrickActive(t){return this._activeBrickEntries.has(t)}async activateBrick(t,e){return await this.activateBricks(t,[e]),this._activeBrickEntries.get(e.id)?.brick}async _activateBrickWithoutDependencies(t,e,i){const r=e.id;if(this._validateActivatingBrickId(e),(e.requiredFlags||e.requiredDraftModels)&&this._brickDependencyCollector.shouldInertBrick(e,i))return;if(this._activeBrickEntries.has(r))return;const a=this._createBrickInstance(e);return this._activateBrickInstance(t,a,r)}async activateBrickInstance(t,e,i){if(!this._activeBrickEntries.has(i))return this._activateBrickInstance(t,e,i)}async _activateBrickInstance(t,e,i){const r=this._createBrickContext(t),a=this._createBrickDeactivator(i),s=e.constructor;return await this._activateBrick(i,{brickConstructor:s,brick:e,context:r},a),e}async collectBricksAndDependencies(t){return this._brickDependencyCollector.collectBricksAndDependencies(t)}async activateBricks(t,e){const i=await this.collectBricksAndDependencies(e);return this._activateBricks(t,i)}async activateBricksUsingPrecomputedDependencies(t,e){return this._activateBricks(t,e)}async _activateBricks(t,e){const i=await this._appConfig.getFeatures(!0);return await Promise.all(e.map((e=>this._activateBrickWithoutDependencies(t,e,i))))}_validateActivatingBrickId(t){const e=t.id;if(!e)throw new Error("Missing brick id property");if(this._activeBrickEntries.has(e)){if(this._activeBrickEntries.get(e).brickConstructor!==t)throw new Error(`Brick with ID "${e}" was already activated with a different constructor`)}if("function"!=typeof t)throw new Error(`Brick with ID "${e}" is not a constructor`);if(t.prototype.requiredFlags||t.prototype.requiredDraftModels)throw new Error(`Brick with ID "${e}" must specify requiredFlags and/or requiredDraftModels as static fields, not instance members`)}_createBrickInstance(t){let e;try{e=new t}catch(e){throw new Error(`TypeError: Brick with ID "${t.id}" threw an exception`)}if("function"!=typeof e.onActivate)throw new Error(`Brick with ID "${t.id}" is missing the activate lifecycle method`);return e}async _activateBrick(t,e,i){this._activeBrickEntries.set(t,e);try{const r=await this._isBrickActivatePerfEnabledDeferred.promise;r&&this._perf.beginStartupAction(`brick-activate-${t}`);const{brick:a,context:s}=e;await a.onActivate(s,i),r&&this._perf.endStartupAction(`brick-activate-${t}`)}catch(e){let i;throw this._activeBrickEntries.delete(t),i=e instanceof a.R?e:new a.R("BrickActivation",`Failed to activate brick with ID "${t}"`,e),this._handleBrickActivationError(i),i}}_handleBrickActivationError(t){l.I.logClientFatalError(t,s.Yd.singleton())}setBrickContextFactory(t){this._brickContextFactory=t}_createBrickContext(t){return void 0===this._brickContextFactory?new n.w(t):this._brickContextFactory(t)}_createBrickDeactivator(t){return async()=>this._deactivateBrick(t)}async _deactivateBrick(t){const e=this._activeBrickEntries.get(t);if(!e)throw new a.R("BrickDeactivation",`Brick "${t}" is not active.`);const{brick:i,context:r}=e;await(i.onDeactivate?.(r)),this._activeBrickEntries.delete(t)}async deactivateBricks(){for(const t of[...this._activeBrickEntries.keys()].reverse())await this._deactivateBrick(t)}async loadDynamicBricks(t,e){e&&await Promise.all(e.map((async e=>{const i=await import(e);return this.activateBrick(t,i.default)})))}get activeBrickIds(){return Array.from(this._activeBrickEntries.keys()).sort()}}},704237:(t,e,i)=>{i.d(e,{I:()=>a});var r=i(718187);class a{static _isChunkLoadError(t){return t instanceof r.R&&void 0!==t.previousError?a._isChunkLoadError(t.previousError):"ChunkLoadError"===t.name}static logClientFatalError(t,e){if(a._isChunkLoadError(t)||!(t instanceof r.R))return;const i={error:t,"custom.brickFatalError":!0};e.error(t.message,i)}static wrap(t,e){return t.catch((t=>{a.logClientFatalError(t,e)})),t}}},330761:(t,e,i)=>{var r;i.d(e,{l:()=>r}),function(t){t.brickManagerConstruction="brick-manager-construction"}(r||(r={}))},67655:(t,e,i)=>{i.d(e,{Q:()=>o});class r{constructor(t){this._trailingFramesCapacity=t,this._trailingFrames=[],this._trailingFramesAvgDuration=0,this._trailingFramesMinDuration=1/0,this._trailingFramesMaxDuration=-1/0,this._needsRecomputeTrailingFramesMinMaxDuration=!0,this._allFramesCount=0,this._allFramesAvgDuration=0,this._allFramesMinDuration=1/0,this._allFramesMaxDuration=-1/0}push(t){if(t.hasEnded)if(this._trailingFrames.push(t),this._allFramesCount++,this._allFramesMinDuration=Math.min(t.duration,this._allFramesMinDuration),this._allFramesMaxDuration=Math.max(this._allFramesMaxDuration,t.duration),this._allFramesAvgDuration=this._allFramesAvgDuration+(t.duration-this._allFramesAvgDuration)/this._allFramesCount,this._trailingFrames.length<=this._trailingFramesCapacity)this._trailingFramesAvgDuration=this._allFramesAvgDuration,this._trailingFramesMinDuration=this._allFramesMinDuration,this._trailingFramesMaxDuration=this._allFramesMaxDuration,this._needsRecomputeTrailingFramesMinMaxDuration=!1;else{const e=this._trailingFrames.shift();this._trailingFramesAvgDuration=this._trailingFramesAvgDuration+(t.duration-e.duration)/this._trailingFramesCapacity,this._needsRecomputeTrailingFramesMinMaxDuration=!0}else console.warn("Complete frame required.")}get trailingFramesCapacity(){return this._trailingFramesCapacity}get trailingFramesCount(){return this._trailingFrames.length}get trailingFrames(){return this._trailingFrames}get trailingAvgDuration(){return this._trailingFramesAvgDuration}get trailingMinDuration(){return this._recomputeTrailingFramesMinMaxDurationIfNeeded(),this._trailingFramesMinDuration}get trailingMaxDuration(){return this._recomputeTrailingFramesMinMaxDurationIfNeeded(),this._trailingFramesMaxDuration}_recomputeTrailingFramesMinMaxDurationIfNeeded(){if(!1!==this._needsRecomputeTrailingFramesMinMaxDuration){this._trailingFramesMinDuration=1/0,this._trailingFramesMaxDuration=-1/0;for(const t of this._trailingFrames){const e=t.duration;e<this._trailingFramesMinDuration&&(this._trailingFramesMinDuration=e),this._trailingFramesMaxDuration<e&&(this._trailingFramesMaxDuration=e)}Number.isFinite(this._trailingFramesMinDuration)||(this._trailingFramesMinDuration=0),Number.isFinite(this._trailingFramesMaxDuration)||(this._trailingFramesMaxDuration=0),this._needsRecomputeTrailingFramesMinMaxDuration=!1}}get framesCount(){return this._allFramesCount}get avgDuration(){return this._allFramesAvgDuration}get minDuration(){return Number.isFinite(this._allFramesMinDuration)?this._allFramesMinDuration:0}get maxDuration(){return Number.isFinite(this._allFramesMaxDuration)?this._trailingFramesMaxDuration:0}}class a{constructor(t,e,i,r,a,s,n,o,c,h){this._category=t,this._name=e,this._id=i,this._startTime=r,this._startTimeOffset=a,this._recordsFrames=s,this._locked=n,this._marked=o,this._frameCapacity=c,this._hasBeenHidden=h,this._endTime=-1,this._framesByName=new Map,this._metadata=void 0,this._endTimeOffset=0}static createForTrailingFrames(t){return new a("","","",-1,0,!0,!1,!1,t,!1)}get hasEnded(){return this._endTime>0}get hasBeenHidden(){return this._hasBeenHidden}set hasBeenHidden(t){this._hasBeenHidden=t}get category(){return this._category}get name(){return this._name}get id(){return this._id}get startTime(){return this._startTime}get endTime(){return this._endTime}get startTimeOffset(){return this._startTimeOffset}get endTimeOffset(){return this._endTimeOffset}set endTimeOffset(t){this._endTimeOffset=t}get recordsFrames(){return this._recordsFrames}get locked(){return this._locked}get marked(){return this._marked}get frameCapacity(){return this._frameCapacity}get duration(){return this.hasEnded?this._endTime-this._startTime:-1}get metadata(){return this._metadata}set metadata(t){this._metadata=t}getFramesByName(t){return this._framesByName.get(t)}getNumFramesByName(t){return this.getFramesByName(t)?.framesCount??0}end(t){t<this._startTime?(console.warn(`PerfAction.end: endTime should be greater than or equal to startTime for action with name "${this.name}" and id "${this.id}".`),this._endTime=this._startTime):this._endTime=t}isFrameInRange(t){return t.startTime>=this._startTime&&(-1===this._endTime||t.endTime<=this._endTime)}pushFrame(t,e){if(!this._recordsFrames)return;let i=this.getFramesByName(t);i||(i=new r(this._frameCapacity),this._framesByName.set(t,i)),i.push(e)}}class s{constructor(t){this._startTime=t,this._endTime=-1}end(t){t<this._startTime?(console.warn("PerfFrame.end: endTime should be greater than or equal to startTime."),this._endTime=this._startTime):this._endTime=t}get hasEnded(){return this._endTime>0}get startTime(){return this._startTime}get endTime(){return this._endTime}get duration(){return this.hasEnded?this._endTime-this._startTime:-1}}var n=i(65464);class o extends n.a{constructor(t){super(t.currentTimeFn,t.timeOrigin,t.currentDateFn),this._completedActions=[],this._openActionsByID=new Map,this._firstTimeOriginActionsById=new Map,this._openFramesByName=new Map,this._hasVisibilityEverBeenHidden="hidden"===document.visibilityState,this._globalActionMetadata={},this._isMonitoringActions=!1,this._onVisibilityChange=()=>{if("hidden"===document.visibilityState){this._hasVisibilityEverBeenHidden=!0;[...this._openActionsByID.values()].forEach((t=>{t.hasBeenHidden=!0}))}},this._maxActions=t.maxActions,this._trailingFramesAction=a.createForTrailingFrames(t.numTrailingFramesToTrack),this._markAllActions=t.markAllActions}get trailingFramesAction(){return this._trailingFramesAction}get completedActions(){return this._completedActions}startMonitoringActions(t){this._isMonitoringActions||(this._isMonitoringActions=!0,this._actionCompleteCallback=t,this.startVisibilityEventListener(),this._completedActions.forEach((e=>t(e))))}stopMonitoringActions(){this._isMonitoringActions&&(this.stopVisibilityEventListener(),this._actionCompleteCallback=void 0,this._isMonitoringActions=!1)}_onActionCompleted(t){let e=!0;this._completedActions.length>=this._maxActions&&(this._removeOldestAction()||(e=!1)),e&&this._completedActions.push(t),this._isMonitoringActions&&void 0!==this._actionCompleteCallback&&this._actionCompleteCallback(t)}registerCompletedAction(t,e,i,r,a,s){const n=a??this.currentTime();super.registerCompletedAction(t,e,i,r,n,s)}startVisibilityEventListener(){document.addEventListener("visibilitychange",this._onVisibilityChange)}stopVisibilityEventListener(){document.removeEventListener("visibilitychange",this._onVisibilityChange)}_beginAction(t,e,i,r,s){if(this._openActionsByID.has(i))return;if("startup"===t&&s.firstTimeOnly&&this._firstTimeOriginActionsById.has(i))return;const n=!!s.originAction&&this._hasVisibilityEverBeenHidden,c=new a(t,e,i,r,s.startTimeOffset??0,s.recordsFrames,s.locked,s.marked,o.DEFAULT_MAX_FRAMES_PER_ACTION,n);this._openActionsByID.set(i,c),"startup"===t&&s.firstTimeOnly&&this._firstTimeOriginActionsById.set(i,c);(this._markAllActions||s.marked)&&this._beginMark(c,s.markStartTime)}_endAction(t,e){const i=this._openActionsByID.get(t);if(!i){if(e.noError)return;return void console.error(`Action not found with id: ${t}`)}const r=this._markAllActions||i.marked;if(i.end(e.endTime),i.endTimeOffset=e.endTimeOffset??0,r&&this._endMark(i),Object.keys(this._globalActionMetadata).length>0){const t=Object.assign({},this._globalActionMetadata,i.metadata);i.metadata=t}this._openActionsByID.delete(i.id),this._onActionCompleted(i)}_setActionMetadata(t,e){const i=this._openActionsByID.get(t);i?i.metadata=e:console.warn(`Action not found with id: ${t}`)}_addActionMetadata(t,e,i){const r=this._openActionsByID.get(t);if(r)r.metadata={...r.metadata,...e};else{if(i.noError)return;console.warn(`Action not found with id: ${t}`)}}_setGlobalActionMetadataEntry(t,e){Object.keys(this._globalActionMetadata).length>=8?console.warn("Too many global metadata values"):void 0!==e?this._globalActionMetadata[t]=e:delete this._globalActionMetadata[t]}_beginFrame(t,e){if(this._openFramesByName.has(t))return void console.error(`Frame has already begun with name: ${t}`);const i=new s(e);this._openFramesByName.set(t,i)}_endFrame(t,e){const i=this._openFramesByName.get(t);i?(i.end(e),this._openFramesByName.delete(t),this._pushFrameToOpenActions(t,i),this._trailingFramesAction.pushFrame(t,i)):console.error(`Frame not found with name: ${t}`)}_pushFrameToOpenActions(t,e){this._openActionsByID.forEach((i=>{i.isFrameInRange(e)&&i.pushFrame(t,e)}))}_removeOldestAction(){const t=this._completedActions.findIndex((t=>!t.locked));return!(t<0)&&(this._completedActions.splice(t,1),!0)}_beginMark(t,e){const i=void 0!==e?{startTime:e}:{startTime:t.startTime-this.timeOrigin};performance.mark(this._getMarkName(t.category,t.id,"begin"),i)}_endMark(t){const e={startTime:t.endTime-this.timeOrigin};performance.mark(this._getMarkName(t.category,t.id,"end"),e),performance.measure(this._getMarkName(t.category,t.id),this._getMarkName(t.category,t.id,"begin"),this._getMarkName(t.category,t.id,"end"))}_getMarkName(t,e,i){return i?`${t}:${e}:${i}`:`${t}:${e}`}}o.DEFAULT_MAX_FRAMES_PER_ACTION=1800},804679:(t,e,i)=>{i.d(e,{X:()=>o});var r=i(938964);class a extends r.c{get storage(){return window.localStorage}}var s=i(563188);class n{read(t){const e=encodeURIComponent(t);let i;if(document.cookie.split(";").some((t=>t.replace(/\s*=.*$/,"").trim()===e&&(i=decodeURIComponent(t.replace(/^[^=]+=\s*/,"").trim()),!0))))return i}write(t,e,i={}){const{path:r,domain:a,maxAge:s,expires:n,samesite:o,secure:c}=i,h=[`${encodeURIComponent(t)}=${encodeURIComponent(e)}`];r&&r.length>0?h.push(`path=${encodeURI(r)}`):void 0===r&&h.push("path=/"),a&&a.length>0&&h.push(`domain=${a}`),s&&s>0&&h.push(`max-age=${s}`),n&&h.push(`expires=${n.toUTCString()}`),!0===c&&h.push("secure"),o&&h.push(`samesite=${o}`),document.cookie=h.join("; ")}delete(t){this.write(t,"",{expires:new Date(0)})}}class o{constructor(){this.id=o.id,this.dependencies=[]}async onActivate({locator:t}){const e=await t.get("Logger");t.set("LocalStorageService",(async()=>new a(e))),t.set("SessionStorageService",(async()=>new s.u(e))),t.set("CookiesUtils",(async()=>new n))}}o.id="@hz/client-storage",o.dependencies=[]},938964:(t,e,i)=>{i.d(e,{c:()=>r});class r{constructor(t){this._logger=t}setInStorage(t,e,i){const r={value:e};if("number"==typeof i){if(i<=0)return void this._logger?.warn(`Setting a storage value for '${t}' with an 'expireAfterMinutes' value of 0 or less is a no-op.`);r.expiry=Date.now()+Math.round(6e4*i)}try{const e=JSON.stringify(r);this.setItemInStorage(t,e)}catch(e){this._logger?.error(`Failed to serialize or persist item with key '${t}'.`,e)}}getFromStorage(t){try{const e=this.storage.getItem(t);if(!e)return;let i;try{i=JSON.parse(e)}catch(t){this._logger?.error(`Failed to parse storage item ${e}`)}if(!i)return;const r=i.expiry;return r&&Date.now()>r?void this.storage.removeItem(t):i.value}catch(t){return void this._logger?.error("Failed to get item from storage",t)}}removeFromStorage(t){this.storage.removeItem(t)}clearStorage(){this.storage.clear()}addItemToStoredArray(t,e,i){const r=this.getFromStorage(t);r&&Array.isArray(r)?(r.push(e),this.setInStorage(t,r,i)):this.setInStorage(t,[e],i)}getDocumentPreference(t,e){if(!t)return void this._logger?.warn("Failed to get document id");const i=this.storage.getItem(t);if(!i)return;let r;try{r=JSON.parse(i)}catch(t){this._logger?.error(`Failed to parse storage item ${i}`)}if(!r)return;return r[e]}setDocumentPreference(t,e,i){if(t)try{const r=this.storage.getItem(t);if(r){const a=JSON.parse(r);a[e]=i;const s=JSON.stringify(a);this.setItemInStorage(t,s)}else{const r={[e]:i},a=JSON.stringify(r);this.storage.setItem(t,a)}}catch(t){this._logger?.error(`Failed to serialize or persist item with key '${e}'.`,t)}else this._logger?.warn("Failed to get document id")}removeDocumentPreference(t,e){if(!t)return void this._logger?.warn("Failed to get document id");const i=this.storage.getItem(t);if(!i)return;let r;try{r=JSON.parse(i)}catch{this._logger?.error(`Failed to parse storage item ${i}`)}if(!r)return;delete r[e];const a=JSON.stringify(r);this.setItemInStorage(t,a)}setItemInStorage(t,e){try{this.storage.setItem(t,e)}catch(t){this._logger?.error("Failed to set item in storage",t)}}}},563188:(t,e,i)=>{i.d(e,{u:()=>a});var r=i(938964);class a extends r.c{get storage(){return window.sessionStorage}}},393292:(t,e,i)=>{i.d(e,{Q:()=>n,Y:()=>a});var r=i(374966);class a{isValidLevelDependency(){return!0}isValidLevel(t){return"foundation"!==t}}async function s(t){const[e,i]=await t.getAll(["AppConfig","PerfMonitorModel"]);return new r.i(e,i,new a)}function n(t){t.set("BrickManager",s)}}}]);
//# sourceMappingURL=26724.6d23ed453c043c18439c.js.map